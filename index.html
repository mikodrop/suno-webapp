<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VibeCraft Studio</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: #121212; /* –ì–ª—É–±–æ–∫–∏–π —á–µ—Ä–Ω—ã–π */
            --card-bg: #1e1e1e;   /* –¢–µ–º–Ω–æ-—Å–µ—Ä—ã–π –¥–ª—è –±–ª–æ–∫–æ–≤ */
            --input-bg: #2c2c2c;  /* –ü–æ–ª—è –≤–≤–æ–¥–∞ */
            --text-main: #ffffff;
            --text-sub: #a0a0a0;
            --accent: #8b5cf6;    /* –§–∏–æ–ª–µ—Ç–æ–≤—ã–π (Suno) */
            --magic: #ffd700;     /* –ó–æ–ª–æ—Ç–æ–π (AI Magic) */
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 16px;
            padding-bottom: 40px;
        }

        /* –ó–∞–≥–æ–ª–æ–≤–∫–∏ –ø–æ–ª–µ–π */
        .label {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-sub);
            margin-bottom: 8px;
            margin-top: 20px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            justify-content: space-between;
        }

        /* –ü–æ–ª—è –≤–≤–æ–¥–∞ */
        input[type="text"], textarea {
            width: 100%;
            background-color: var(--input-bg);
            border: 1px solid transparent;
            border-radius: 12px;
            padding: 14px;
            color: var(--text-main);
            font-size: 16px;
            box-sizing: border-box;
            outline: none;
            transition: 0.2s;
            font-family: inherit;
        }
        input:focus, textarea:focus {
            border-color: var(--accent);
            background-color: #333;
        }
        textarea { resize: none; }

        /* --- –ß–ò–ü–°–´ –°–¢–ò–õ–ï–ô (–ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞) --- */
        .chips-container {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 5px;
            scrollbar-width: none; /* –°–∫—Ä—ã—Ç—å —Å–∫—Ä–æ–ª–ª */
        }
        .chips-container::-webkit-scrollbar { display: none; }

        .chip {
            background-color: var(--card-bg);
            border: 1px solid #333;
            color: var(--text-main);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            white-space: nowrap;
            cursor: pointer;
            transition: 0.2s;
        }
        .chip:active { transform: scale(0.95); }
        .chip.selected {
            background-color: var(--accent);
            border-color: var(--accent);
            color: white;
        }

        /* --- –¢–£–ú–ë–õ–ï–†–´ (Instrumental / Magic) --- */
        .toggle-card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }
        
        /* –°—Ç–∏–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è */
        .switch { position: relative; display: inline-block; width: 50px; height: 28px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
            background-color: #444; transition: .4s; border-radius: 34px;
        }
        .slider:before {
            position: absolute; content: ""; height: 22px; width: 22px; left: 3px; bottom: 3px;
            background-color: white; transition: .4s; border-radius: 50%;
        }
        input:checked + .slider { background-color: var(--accent); }
        input:checked + .slider:before { transform: translateX(22px); }

        /* –û—Å–æ–±—ã–π —Å—Ç–∏–ª—å –¥–ª—è Magic Toggle */
        .magic-card {
            border: 1px solid rgba(255, 215, 0, 0.3);
            background: linear-gradient(135deg, #1e1e1e 0%, #2a2500 100%);
        }
        .magic-text { color: var(--magic); font-weight: bold; display: flex; align-items: center; gap: 8px; }
        .magic-switch input:checked + .slider { background-color: var(--magic); }

        /* –ü–æ–¥—Å–∫–∞–∑–∫–∏ */
        .hint { font-size: 12px; color: #666; margin-top: 6px; }

        /* –°–∫—Ä—ã—Ç–∏–µ –±–ª–æ–∫–æ–≤ */
        .hidden { display: none; }

    </style>
</head>
<body>

    <div class="label">1. –ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞</div>
    <input type="text" id="title" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –õ—é–±–æ–≤—å –∏ –†–æ–±–æ—Ç—ã">

    <div class="label">2. –°—Ç–∏–ª—å –º—É–∑—ã–∫–∏</div>
    <div class="chips-container" id="style-chips">
        <div class="chip" onclick="selectStyle('Pop')">Pop</div>
        <div class="chip" onclick="selectStyle('Rock')">Rock</div>
        <div class="chip" onclick="selectStyle('Phonk')">Phonk</div>
        <div class="chip" onclick="selectStyle('Rap')">Rap</div>
        <div class="chip" onclick="selectStyle('Jazz')">Jazz</div>
        <div class="chip" onclick="selectStyle('Electronic')">Electronic</div>
    </div>
    <input type="text" id="style" style="margin-top: 10px;" placeholder="–ò–ª–∏ –Ω–∞–ø–∏—à–∏ —Å–≤–æ–π (Dark Techno...)">

    <div class="toggle-card">
        <span>üéª –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª (–±–µ–∑ —Å–ª–æ–≤)</span>
        <label class="switch">
            <input type="checkbox" id="instrumental" onchange="toggleFields()">
            <span class="slider"></span>
        </label>
    </div>

    <div id="lyrics-section">
        
        <div class="label">3. –û —á–µ–º –ø–µ—Å–Ω—è? (–¢–µ–º–∞)</div>
        <input type="text" id="topic" placeholder="–ü–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –¥–µ–≤—É—à–∫–∏ –ê–ª–∏–Ω—ã...">
        <div class="hint">–ë–æ—Ç –ø—Ä–∏–¥—É–º–∞–µ—Ç —Ç–µ–∫—Å—Ç –Ω–∞ —ç—Ç—É —Ç–µ–º—É.</div>

        <div class="label" style="margin-top: 25px;">5. –¢–µ–∫—Å—Ç –ø–µ—Å–Ω–∏ (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</div>
        <textarea id="lyrics" rows="5" placeholder="–ï—Å–ª–∏ –µ—Å—Ç—å —Å–≤–æ–∏ —Å—Ç–∏—Ö–∏ - –≤—Å—Ç–∞–≤—å —Å—é–¥–∞.&#10;–ï—Å–ª–∏ –ø—É—Å—Ç–æ - AI –Ω–∞–ø–∏—à–µ—Ç —Å–∞–º –ø–æ —Ç–µ–º–µ –≤—ã—à–µ."></textarea>
    
    </div>

    <div class="toggle-card magic-card">
        <span class="magic-text">‚ú® –£–ª—É—á—à–∏—Ç—å –ø—Ä–æ–º—Ç (AI Magic)</span>
        <label class="switch magic-switch">
            <input type="checkbox" id="magic" checked>
            <span class="slider"></span>
        </label>
    </div>

<script>
    let tg = window.Telegram.WebApp;
    tg.expand();
    
    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –≥–ª–∞–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
    tg.MainButton.text = "–°–û–ó–î–ê–¢–¨ –¢–†–ï–ö üöÄ";
    tg.MainButton.color = "#8b5cf6"; // –§–∏–æ–ª–µ—Ç–æ–≤—ã–π
    tg.MainButton.show();

    // –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ —Å—Ç–∏–ª—è (—á–∏–ø—Å—ã)
    function selectStyle(val) {
        document.getElementById('style').value = val;
        // –í–∏–∑—É–∞–ª—å–Ω–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ
        document.querySelectorAll('.chip').forEach(c => c.classList.remove('selected'));
        event.target.classList.add('selected');
        // –í–∏–±—Ä–∞—Ü–∏—è
        if(tg.HapticFeedback) tg.HapticFeedback.impactOccurred('light');
    }

    // –õ–æ–≥–∏–∫–∞ —Å–∫—Ä—ã—Ç–∏—è –ø–æ–ª–µ–π –ø—Ä–∏ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª–µ
    function toggleFields() {
        let isInst = document.getElementById('instrumental').checked;
        let section = document.getElementById('lyrics-section');
        
        if (isInst) {
            section.style.display = 'none';
        } else {
            section.style.display = 'block';
        }
    }

    // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    Telegram.WebApp.onEvent('mainButtonClicked', function(){
        let title = document.getElementById("title").value.trim();
        let style = document.getElementById("style").value.trim();
        let topic = document.getElementById("topic").value.trim();
        let lyrics = document.getElementById("lyrics").value.trim();
        let isInst = document.getElementById("instrumental").checked;
        let useMagic = document.getElementById("magic").checked;

        // –í–∞–ª–∏–¥–∞—Ü–∏—è
        if (!style) {
            tg.showPopup({title: "–û—à–∏–±–∫–∞", message: "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏ –∏–ª–∏ –Ω–∞–ø–∏—à–∏ —Å—Ç–∏–ª—å –º—É–∑—ã–∫–∏!"});
            return;
        }

        // –°–æ–±–∏—Ä–∞–µ–º –æ–±—ä–µ–∫—Ç
        let data = {
            title: title || "New Track",
            style: style,
            topic: topic,      // –ù–æ–≤–æ–µ –ø–æ–ª–µ "–¢–µ–º–∞"
            lyrics: lyrics,    // –ü–æ–ª–µ "–¢–µ–∫—Å—Ç"
            is_instrumental: isInst,
            use_magic: useMagic
        };

        tg.sendData(JSON.stringify(data));
    });
</script>
</body>
</html>
