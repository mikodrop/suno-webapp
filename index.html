<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VibeCraft Creator</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            background-color: var(--tg-theme-bg-color, #181818);
            color: var(--tg-theme-text-color, #ffffff);
            font-family: sans-serif;
            padding: 20px;
            margin: 0;
        }
        .container { display: flex; flex-direction: column; gap: 15px; }
        
        label { font-weight: bold; margin-bottom: 5px; display: block; }
        
        /* –¢–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è */
        textarea, input[type="text"] {
            width: 100%;
            padding: 12px;
            border-radius: 12px;
            border: 1px solid #333;
            background-color: var(--tg-theme-secondary-bg-color, #2a2a2a);
            color: var(--tg-theme-text-color, #fff);
            font-size: 16px;
            resize: none;
            box-sizing: border-box; /* –í–∞–∂–Ω–æ, —á—Ç–æ–±—ã –Ω–µ –≤—ã–ª–µ–∑–∞–ª–æ –∑–∞ –∫—Ä–∞—è */
        }
        textarea:focus, input:focus { outline: 2px solid #6c5ce7; }

        /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å (Toggle) */
        .toggle-container {
            display: flex; justify-content: space-between; align-items: center;
            background: var(--tg-theme-secondary-bg-color, #2a2a2a);
            padding: 15px; border-radius: 12px;
        }
        .switch {
            position: relative; display: inline-block; width: 50px; height: 28px;
        }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
            background-color: #ccc; transition: .4s; border-radius: 34px;
        }
        .slider:before {
            position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px;
            background-color: white; transition: .4s; border-radius: 50%;
        }
        input:checked + .slider { background-color: #6c5ce7; }
        input:checked + .slider:before { transform: translateX(22px); }

        /* –ü–æ–¥—Å–∫–∞–∑–∫–∏ */
        .hint { font-size: 12px; color: #888; margin-top: 5px; }
    </style>
</head>
<body>

<div class="container">
    
    <div class="toggle-container">
        <span>üéª –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª (–±–µ–∑ —Å–ª–æ–≤)</span>
        <label class="switch">
            <input type="checkbox" id="instrumental">
            <span class="slider"></span>
        </label>
    </div>

    <div>
        <label for="prompt">üí° –û–ø–∏—Å–∞–Ω–∏–µ –∏–ª–∏ –¢–µ–∫—Å—Ç –ø–µ—Å–Ω–∏</label>
        <textarea id="prompt" rows="4" placeholder="–ì—Ä—É—Å—Ç–Ω—ã–π —Ä—ç–ø –ø—Ä–æ —ç–∫–∑–∞–º–µ–Ω—ã... –ò–õ–ò –í—Å—Ç–∞–≤—å —Å—é–¥–∞ —Å–≤–æ–π —Ç–µ–∫—Å—Ç"></textarea>
        <div class="hint" id="mode-hint">–ï—Å–ª–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª –≤—ã–∫–ª—é—á–µ–Ω, AI —Å–ø–æ–µ—Ç —ç—Ç–æ—Ç —Ç–µ–∫—Å—Ç (–∏–ª–∏ –ø—Ä–∏–¥—É–º–∞–µ—Ç –µ–≥–æ).</div>
    </div>

    <div>
        <label for="style">üé∏ –°—Ç–∏–ª—å / –ñ–∞–Ω—Ä</label>
        <input type="text" id="style" placeholder="Pop, Rock, Phonk, Jazz...">
    </div>

    <div>
        <label for="title">üè∑ –ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞</label>
        <input type="text" id="title" placeholder="My Hit Song">
    </div>

</div>

<script>
    let tg = window.Telegram.WebApp;
    tg.expand(); // –†–∞—Å—Ç—è–Ω—É—Ç—å –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω

    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ì–ª–∞–≤–Ω—É—é –ö–Ω–æ–ø–∫—É (MainButton)
    tg.MainButton.text = "–°–û–ó–î–ê–¢–¨ –¢–†–ï–ö üöÄ";
    tg.MainButton.show();

    // –õ–æ–≥–∏–∫–∞ –Ω–∞–∂–∞—Ç–∏—è
    Telegram.WebApp.onEvent('mainButtonClicked', function(){
        let isInstrumental = document.getElementById("instrumental").checked;
        let promptText = document.getElementById("prompt").value;
        let styleText = document.getElementById("style").value;
        let titleText = document.getElementById("title").value;

        // –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
        if (promptText.trim() === "" && !isInstrumental) {
            tg.showPopup({title: "–û—à–∏–±–∫–∞", message: "–ù–∞–ø–∏—à–∏ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–ª–∏ —Ç–µ–∫—Å—Ç –ø–µ—Å–Ω–∏!"});
            return;
        }
        if (styleText.trim() === "") {
            tg.showPopup({title: "–û—à–∏–±–∫–∞", message: "–£–∫–∞–∂–∏ —Å—Ç–∏–ª—å –º—É–∑—ã–∫–∏!"});
            return;
        }

        // –§–æ—Ä–º–∏—Ä—É–µ–º JSON –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –±–æ—Ç—É
        let data = {
            mode: isInstrumental ? "instrumental" : "normal",
            description: promptText,
            genre: styleText,
            title: titleText || "VibeCraft Track"
        };

        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏ –∑–∞–∫—Ä—ã–≤–∞–µ–º
        tg.sendData(JSON.stringify(data));
    });

</script>
</body>
</html>